## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, AgeDecade, Race3) |>
summarise(number_observations = n()) |>
complete(Gender, AgeDecade, Race3, fill = list(number_observations = 0))
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, AgeDecade, Race3) |>
summarise(number_observations = n(), .groups = "drop") |>
complete(Gender, AgeDecade, Race3, fill = list(number_observations = 0))
filter(number_observations < 5) |>
kable()
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, AgeDecade, Race3) |>
summarise(number_observations = n(), .groups = "drop") |>
complete(Gender, AgeDecade, Race3, fill = list(number_observations = 0)) |>
filter(number_observations < 5) |>
kable()
View(dat)
## code here
dat <- NHANES |> filter(SurveyYr = "2011_12")
## code here
dat <- NHANES |> filter(SurveyYr = "2011_12")
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12")
dat <- dat |> filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(fct_collapse(AgeDecade, "60+" = c(" 60-69", " 70+")) |>
filter(Race3 != "Other") |>
mutate(Race = Race3)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12")
dat <- dat |> filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(fct_collapse(AgeDecade, "60+" = c(" 60-69", " 70+"))) |>
filter(Race3 != "Other") |>
mutate(Race = Race3)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12")
dat <- dat |> filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9")
dat <- dat |> mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+"))))
dat <- dat |> mutate(Race = Race3)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12") |>
filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+")))) |>
mutate(Race = Race3)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race)) + geom_line() + geom_point() + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race)) + geom_line() + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race)) + geom_point() + geom_line() + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race)) + geom_point() + geom_line(size = 2) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race)) + geom_point() + geom_line(linewidth = 2) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race)) + geom_point() + geom_line(linewidth = 2) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point() + geom_line(linewidth = 2) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point(size = 2) + geom_line(linewidth = 1) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point(size = 2) + geom_line(linewidth = 0.5) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12") |>
filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+")))) |>
filter(Race3 != "Other") |>
mutate(Race = Race3)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point(size = 2) + geom_line(linewidth = 0.5) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> select("Black", "White") |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> select(Race == "Black", Race == "White") |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
View(dat)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12") |>
filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+")))) |>
filter(Race3 != "Other") |>
mutate(Race = Race3)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12") |>
filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+")))) |>
filter(Race3 != "Other") |>
mutate(Race = Race3)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point(size = 2) + geom_line(linewidth = 0.5) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
View(dat)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12") |>
filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+")))) |>
filter(Race3 != "Other") |>
rename(Race = Race3)
View(dat)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point(size = 2) + geom_line(linewidth = 0.5) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> select(Race == "Black", Race == "White") |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
p5 <- groups_picked |> ggplot(aes(AgeDecade, average)) + geom_point(size = 3, color = "blue") + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across Black and White", caption = "Bars represent 95% confidence intervals")
print(p5)
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
p5 <- groups_picked |> ggplot(aes(AgeDecade, average), color = Race) + geom_point(size = 3, color = "blue") + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across Black and White", caption = "Bars represent 95% confidence intervals")
print(p5)
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
p5 <- groups_picked |> ggplot(aes(AgeDecade, average)) + geom_point(size = 3, color = "blue") + geom_errorbar(aes(ymin = lower, ymax = upper), color = Race) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across Black and White", caption = "Bars represent 95% confidence intervals")
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
p5 <- groups_picked |> ggplot(aes(AgeDecade, average)) + geom_point(size = 3, color = Race) + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across Black and White", caption = "Bars represent 95% confidence intervals")
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
p5 <- groups_picked |> ggplot(aes(AgeDecade, average, color = Race)) + geom_point(size = 3) + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across Black and White", caption = "Bars represent 95% confidence intervals")
print(p5)
## code here
difference <- groups_picked |>
pivot_wider(names_from = Race, values_from = average) |>
mutate(Black - White)
## code here
difference <- groups_picked |>
pivot_wider(names_from = Race, values_from = average) |>
mutate(Black - White) |>
kable()
## code here
difference <- groups_picked |>
pivot_wider(names_from = Race, values_from = average) |>
mutate(Difference = Black - White) |>
kable()
## code here
difference <- groups_picked |>
pivot_wider(names_from = Race, values_from = average) |>
mutate(Difference = Black - White)
difference
## code here
difference <- groups_picked |>
pivot_wider(names_from = Race, values_from = average) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
difference = average$Black - average$White)
## code here
difference <- groups_picked |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = mean_Black - mean_White) |>
select(AgeDecade, Gender, Difference)
## code here
difference <- dat |> filter(Race %in% c("Black", "White")) |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = mean_Black - mean_White) |>
select(AgeDecade, Gender, Difference)
## code here
difference <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(AgeDecade, Gender, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = mean_Black - mean_White) |>
select(AgeDecade, Gender, Difference)
## code here
difference <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(AgeDecade, Gender, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = Black - White) |>
select(AgeDecade, Gender, Difference)
difference
## code here
difference <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(AgeDecade, Gender, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = Black - White) |>
select(AgeDecade, Gender, Difference) |>
pivot_wider(names_from = Gender, values_from = Difference) |>
kable()
## code here
difference <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(AgeDecade, Gender, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = Black - White) |>
select(AgeDecade, Gender, Difference) |>
pivot_wider(names_from = Gender, values_from = Difference)
difference
#| message: false
library(dplyr)
library(tidyr)
library(forcats)
library(ggplot2)
library(knitr)
library(NHANES)
options(digits = 2)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12")
dat
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE)) |>
kable()
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, Race3) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE)) |>
arrange(desc(average)) |>
kable()
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, Race3) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(desc(average)) |>
kable()
## code here
dat_new <- dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, Race3) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
SD = sd(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(desc(average))
p1 <- dat_new |> ggplot(aes(Race3,average)) + geom_point(size = 3, color = "blue") + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "Race", y = "Average", title = "Comparing systolic blood pressure across groups", caption = "Bars represent 95% confidence intervals")
print(p1)
## code here
dat |> filter(!is.na(BPSysAve),!is.na(AgeDecade)) |>
group_by(Gender, AgeDecade) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(AgeDecade) |>
kable()
dat_new_age <-  dat |> filter(!is.na(BPSysAve), !is.na(AgeDecade)) |>
group_by(Gender, AgeDecade) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
SD = sd(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(AgeDecade)
p2 <- dat_new_age |> ggplot(aes(AgeDecade,average)) + geom_point(size = 3, color = "blue") + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across groups", caption = "Bars represent 95% confidence intervals")
print(p2)
## code here
p3 <- dat |> filter(!is.na(Age),!is.na(Race3)) |>
ggplot(aes(Age)) + geom_histogram(binwidth = 5) + facet_grid(Gender ~ Race3) + labs(x = "Age", y = "Count", title = "Age Distribution among Races")
print(p3)
#comment: The age distribution in Mexician is roughly decreasing and the majority is in a yougn age below 20, for the distribution of White, there are a large number participants aged in every age decade greater than 20. As there are more aged participants in White, and SBP increases with age, it's likely to observe difference of SBP between Mexcian and White in this dataset.
## code here
dat |> filter(!is.na(Age), !is.na(Race3)) |>
group_by(Race3) |>
summarise(median_age = median(Age, na.rm = TRUE),
children = sum(Age < 18) / n() * 100) |>
arrange(median_age) |>
kable()
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, AgeDecade, Race3) |>
summarise(number_observations = n(), .groups = "drop") |>
complete(Gender, AgeDecade, Race3, fill = list(number_observations = 0)) |>
filter(number_observations < 5) |>
kable()
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12") |>
filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+")))) |>
filter(Race3 != "Other") |>
rename(Race = Race3)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point(size = 2) + geom_line(linewidth = 0.5) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
p5 <- groups_picked |> ggplot(aes(AgeDecade, average, color = Race)) + geom_point(size = 3) + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across Black and White", caption = "Bars represent 95% confidence intervals")
print(p5)
## code here
difference <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(AgeDecade, Gender, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = Black - White) |>
select(AgeDecade, Gender, Difference) |>
pivot_wider(names_from = Gender, values_from = Difference)
difference
#| message: false
library(dplyr)
library(tidyr)
library(forcats)
library(ggplot2)
library(knitr)
library(NHANES)
options(digits = 2)
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12")
dat
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE)) |>
kable()
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, Race3) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE)) |>
arrange(desc(average)) |>
kable()
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, Race3) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(desc(average)) |>
kable()
## code here
dat_new <- dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, Race3) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
SD = sd(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(desc(average))
p1 <- dat_new |> ggplot(aes(Race3,average)) + geom_point(size = 3, color = "blue") + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "Race", y = "Average", title = "Comparing systolic blood pressure across groups", caption = "Bars represent 95% confidence intervals")
print(p1)
## code here
dat |> filter(!is.na(BPSysAve),!is.na(AgeDecade)) |>
group_by(Gender, AgeDecade) |>
summarise(average = mean(BPSysAve,na.rm = TRUE),
SD = sd(BPSysAve,na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(AgeDecade) |>
kable()
dat_new_age <-  dat |> filter(!is.na(BPSysAve), !is.na(AgeDecade)) |>
group_by(Gender, AgeDecade) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
SD = sd(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (SD / sqrt(n())),
upper = average + 1.96 * (SD / sqrt(n()))) |>
arrange(AgeDecade)
p2 <- dat_new_age |> ggplot(aes(AgeDecade,average)) + geom_point(size = 3, color = "blue") + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across groups", caption = "Bars represent 95% confidence intervals")
print(p2)
## code here
p3 <- dat |> filter(!is.na(Age),!is.na(Race3)) |>
ggplot(aes(Age)) + geom_histogram(binwidth = 5) + facet_grid(Gender ~ Race3) + labs(x = "Age", y = "Count", title = "Age Distribution among Races")
print(p3)
#comment: The age distribution in Mexician is roughly decreasing and the majority is in a yougn age below 20, for the distribution of White, there are a large number participants aged in every age decade greater than 20. As there are more aged participants in White, and SBP increases with age, it's likely to observe difference of SBP between Mexcian and White in this dataset.
## code here
dat |> filter(!is.na(Age), !is.na(Race3)) |>
group_by(Race3) |>
summarise(median_age = median(Age, na.rm = TRUE),
children = sum(Age < 18) / n() * 100) |>
arrange(median_age) |>
kable()
## code here
dat |> filter(!is.na(BPSysAve)) |>
group_by(Gender, AgeDecade, Race3) |>
summarise(number_observations = n(), .groups = "drop") |>
complete(Gender, AgeDecade, Race3, fill = list(number_observations = 0)) |>
filter(number_observations < 5) |>
kable()
## code here
dat <- NHANES |> filter(SurveyYr == "2011_12") |>
filter(!is.na(AgeDecade)) |> filter(AgeDecade != " 0-9") |>
mutate(AgeDecade = fct_drop(fct_collapse(AgeDecade, `60+` = c(" 60-69", " 70+")))) |>
filter(Race3 != "Other") |>
rename(Race = Race3)
## code here
p4 <- dat |> group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n()))) |>
ggplot(aes(AgeDecade, average, color = Race, group = Race)) + geom_point(size = 2) + geom_line(linewidth = 0.5) + facet_wrap(~ Gender) + labs(x = "Age Decade", y = "Average BPS", title = "Comparing systolic blood pressure across groups")
print(p4)
## code here
#The line represents Black is always above the line represents White
groups_picked <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(Gender, AgeDecade, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE),
lower = average - 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())),
upper = average + 1.96 * (sd(BPSysAve, na.rm = TRUE) / sqrt(n())))
p5 <- groups_picked |> ggplot(aes(AgeDecade, average, color = Race)) + geom_point(size = 3) + geom_errorbar(aes(ymin = lower, ymax = upper)) + facet_wrap(~ Gender) + labs(x = "AgeDecade", y = "Average", title = "Comparing systolic blood pressure across Black and White", caption = "Bars represent 95% confidence intervals")
print(p5)
## code here
difference <- dat |> filter(Race %in% c("Black", "White")) |>
group_by(AgeDecade, Gender, Race) |>
summarise(average = mean(BPSysAve, na.rm = TRUE), .groups = "drop") |>
pivot_wider(names_from = Race, values_from =  average) |>
mutate(Difference = Black - White) |>
select(AgeDecade, Gender, Difference) |>
pivot_wider(names_from = Gender, values_from = Difference)
difference
